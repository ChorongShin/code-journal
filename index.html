<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Code Journal</title>
  <link rel="icon" href="images/favicon.ico">
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Catamaran:wght@200;400;700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/styles.css">
  <script>
    var $exit = document.querySelector('.exit');

      var $titleInput = document.querySelector('#title');
      var $photoInput = document.querySelector('#photo-url');
      var $notesInput = document.querySelector('#notes');
      var $placeHolder = document.querySelector('.placeholder');
  document.addEventListener('DOMContentLoaded', function (event) {
      for (var entryIndex = 0; entryIndex < data.entries.length; entryIndex++) {
        var $entry = renderEntry(data.entries[entryIndex]);
        $entryList.appendChild($entry);
        handleView('entries');
      }

      $exit.remove();
    handleView(data.view);

      $entryList.addEventListener('click', function (event) {

        if (event.target.tagName !== 'I') {
          return;
        }

        var closest = event.target.closest('ul > li');
        var closestEntryId = parseInt(closest.getAttribute('data-entry-id'), 10);

        for (var i = 0; i < data.entries.length; i++) {
          if (data.entries[i].entryId === closestEntryId) {
            data.editing = data.entries[i];

            $titleInput.value = data.editing.title;
            $photoInput.value = data.editing.photo;
            $notesInput.value = data.editing.notes;
            $placeHolder.src = data.editing.photo;

            var entry = {
              title: data.editing.title,
              photo: data.editing.photo,
              notes: data.editing.notes,
              entryId: data.editing.entryId
            };

            data.editFormValues = entry;

            if (data.editFormValues !== null) {

              console.log(data.editFormValues);

              $titleInput.value = data.editFormValues.title;
              $photoInput.value = data.editFormValues.photo;
              $notesInput.value = data.editFormValues.notes;
              $placeHolder.src = data.editFormValues.photo;
              $newEntry.className = 'hidden';
              $editEntry.className = 'entry-title view';
              handleView('entry-form');

            }
          }
        }
      });


    if (data.editFormValues !== null) {
      $titleInput.value = data.editFormValues.title;
      $photoInput.value = data.editFormValues.photo;
      $notesInput.value = data.editFormValues.notes;
      $placeHolder.src = data.editFormValues.photo;
      $newEntry.className = 'hidden';
      $editEntry.className = 'entry-title view';
       handleView('entry-form');
         data.editFormValues = null;
          data.editing.title = entry.title;
      data.editing.photo = entry.photo;
      data.editing.notes = entry.notes;
       $entries[i].replaceWith(renderEntry(data.editing));
      $placeholder.src = 'images/placeholder-image-square.jpg';
      $entryForm.reset();
      data.editing = null;
      handleView('entries');
      $newEntry.className = 'entry-title view';
      $editEntry.className = 'hidden';
    }



    });
  </script>
</head>
<body>
  <header class="page-container">
    <div class="container">
      <div class="row">
        <div class="column-sm-half column-header">
          <p class="code-journal">Code Journal</p>
        </div>
        <div class="column-sm-half column-header anchor">
          <a href="#" class="entry-header">Entries</a>
        </div>
      </div>
    </div>
  </header>
  <main>
    <div data-view="entry-form" class="hidden">
      <div class="container">
        <div class="row">
          <div class="column-full">
            <p class="entry-title new-entry">New Entry</p>
            <p class="entry-title edit-entry hidden">Edit Entry</p>
          </div>
        </div>
      </div>
      <form class="entry-form">
        <div class="container">
          <div class="row">
            <div class="column-half">
              <div class="entry-img">
                <img class="placeholder" src="images/placeholder-image-square.jpg" alt="placeholder-image-square">
              </div>
            </div>
            <div class="column-half">
              <label for="title">Title</label>
              <input type="text" name="title" id="title" required>
              <label for="photo-url" class="label-margin">Photo URL</label>
              <input type="url" name="photo" id="photo-url" required>
            </div>
          </div>
          <div class="row label-margin">
            <div class="column-full">
              <label for="notes">Notes</label>
              <textarea name="notes" id="notes" required>
              </textarea>
            </div>
          </div>
          <div class="row">
            <div class="column-half"></div>
            <div class="column-half">
              <div class="save-button-div">
                <button type="submit" class="save-button">SAVE</button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>

    <div data-view="entries">
      <div class="container">
        <div class="row">
          <div class="column-half entries-header">
            <p class="entry-title">Entries</p>
          </div>
          <div class="column-half entries-header">
            <div class="new-anchor">
              <a href="#" class="new">NEW</a>
            </div>
          </div>
        </div>
        <div class="row exit">
          <div class="column-full">
            <p class="no-entries view">No entries have been recorded.</p>
          </div>
        </div>
        <ul id="entry-list">
        </ul>
      </div>
    </div>

    <!-- <div data-view="edit-entry" class="hidden">
      <div class="container">
        <div class="row">
          <div class="column-half entries-header">
            <p class="entry-title">Edit Entry</p>
          </div>
        </div>
      </div>
      <form class="edit-form">
        <div class="form-container"></div>
      </form>
    </div> -->

  </main>
  <script src="js/data.js"></script>
  <script src="js/main.js"></script>
</body>
</html>
